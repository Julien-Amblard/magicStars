var Stars=function(t){this.focus=!1,this.mouse={x:0,y:0},this.stars=[],this.canvas,this.ctx,this.img=t.pattern,this.c=t.container,this.id=t.id?t.id:"stars",this.life=t.life?t.life:5,this.w=t.width?t.width:this.img.width,this.pop=t.popDist?t.popDist:2,this.speed=t.speed?t.speed:5,this.gravity=t.gravity?t.gravity:2,this.init()};Stars.prototype.init=function(){this.bindClick(),this.buildScene(),this.start()},Stars.prototype.rand=function(t,s){return Math.random()*(s-t)+t},Stars.prototype.buildScene=function(){this.canvas=document.createElement("canvas"),this.canvas.id=this.id,this.canvas.width=this.c.clientWidth,this.canvas.height=this.c.clientHeight,this.ctx=this.canvas.getContext("2d"),this.c.appendChild(this.canvas),this.res=this.resize.bind(this),this.c.addEventListener("resize",this.res)},Stars.prototype.resize=function(){this.canvas.width=this.c.clientWidth,this.canvas.height=this.c.clientHeight},Stars.prototype.bindClick=function(){this.bindmove=this.bindMove.bind(this),this.c.addEventListener("mousedown",this.bindmove)},Stars.prototype.bindMove=function(){this.add=this.addStar.bind(this),this.c.addEventListener("mousemove",this.add),this.stop=this.unbindMove.bind(this),document.body.addEventListener("mouseup",this.stop),this.focus=!0},Stars.prototype.unbindMove=function(){this.c.removeEventListener("mousemove",this.add),document.body.removeEventListener("mouseup",this.stop),this.focus=!1},Stars.prototype.getMouseVars=function(){this.mouse.y=event.layerY,this.mouse.x=event.layerX},Stars.prototype.buildStar=function(){return{x:this.rand(this.mouse.x-this.pop,this.mouse.x+this.pop),y:this.rand(this.mouse.y-this.pop,this.mouse.y+this.pop),r:this.rand(0,360),w:this.rand(this.w/3,this.w),a:this.rand(0,1.3),vx:this.rand(-this.speed,this.speed),vy:this.rand(-this.speed,this.speed),vr:this.rand(-(10*this.speed),10*this.speed),life:this.rand(this.life/2,this.life),update:this.rand(0,1)}},Stars.prototype.addStar=function(){this.getMouseVars(),this.focus&&(this.stars.push(this.buildStar()),this.stars.push(this.buildStar()),this.stars.push(this.buildStar()),this.stars.push(this.buildStar()),this.stars.push(this.buildStar()))},Stars.prototype.update=function(){for(var t=this.stars.length-1;t>=0;t--)this.stars[t].x+=this.stars[t].vx,this.stars[t].y+=this.stars[t].vy,this.stars[t].vy+=this.gravity/10,this.stars[t].vx+=this.gravity/100,this.stars[t].life<0||this.stars[t].y>this.canvas.height?(this.stars[t].a-=.06,this.stars[t].r+=this.stars[t].vr,this.stars[t].a<0&&this.stars.splice(t,1)):(this.stars[t].update<=0?(this.stars[t].w=this.rand(this.w/3,this.w),this.stars[t].a=this.rand(.6,1.3),this.stars[t].r=this.rand(0,360),this.stars[t].vr=this.rand(-(10*this.speed),10*this.speed),this.stars[t].update=this.rand(-1,1)):this.stars[t].update-=.1,this.stars[t].r+=this.stars[t].vr,this.stars[t].life-=.1)},Stars.prototype.draw=function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.globalCompositeOperation="lighter";for(var t=this.stars.length-1;t>=0;t--){var s=this.stars[t];this.ctx.save(),this.ctx.translate(s.x-s.w/2,s.y-s.w/2),this.ctx.rotate(s.r*Math.PI/180),this.ctx.globalAlpha=s.a,this.ctx.drawImage(this.img,0,0,this.img.width,this.img.height,0,0,s.w,s.w),this.ctx.restore()}this.ctx.globalCompositeOperation="source-over"},Stars.prototype.start=function(){this.running=!0,this.run()},Stars.prototype.stop=function(){this.running=!1},Stars.prototype.run=function(){this.update(),this.draw(),loop=this.run.bind(this),this.running&&requestAnimationFrame(loop)};